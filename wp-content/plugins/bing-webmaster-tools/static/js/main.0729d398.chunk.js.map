{"version":3,"sources":["components/ErrorConstants.tsx","components/APIHelper.tsx","components/withDashboardData.tsx","Constants.ts","components/Header.tsx","components/StartPage.tsx","components/Card.tsx","components/Dashboard.tsx","components/App.tsx","serviceWorker.js","index.js"],"names":["ErrorConstants","HttpStatusCode","Code","Message","baseURL","window","nonceHeader","headers","useFetch","requestUrl","a","withTimeout","Promise","resolve","reject","response","fetch","then","res","json","body","ok","data","error","catch","err","useSubmit","requestData","method","JSON","stringify","promise","timer","timeout","race","_","timeoutInit","status","Response","setTimeout","code","message","result","clearTimeout","console","SetApiKey","apiKey","apiContent","APIKey","failedSubmissions","param","Submissions","isEnabled","AutoSubmissionEnabled","url","StringConstants","ApiKeyHelpLink","BingWebmasterLink","PluginInfoLink","ApiKeyValidationError","UrlSubmitErrorMessage","ApiKeyRegex","RegExp","SubmitUrlRegex","logosvg","xmlns","width","height","viewBox","fill","transform","d","mobileLogoSvg","Header","className","title","onClick","open","key","Icon","iconName","StartPage","props","useState","setApiKey","TextField","type","value","onChange","event","item","placeholder","validateOnLoad","onGetErrorMessage","test","length","href","target","PrimaryButton","text","error_type","setAPIKeyAdded","addBanner","disabled","Card","tooltipId","useId","tooltipProps","onRenderContent","tooltip","leadingIconName","TooltipHost","closeDelay","directionalHint","id","aria-describedby","children","Dashboard","DashboardModalState","apiKeyInvalid","setApiKeyInvalid","apiSettings","setAPISettings","submissionStats","setSubmissionStats","submissionsList","setSubmissionsList","showApiKeyPopOverMenu","setShowApiKeyPopOverMenu","showAutoSubmissionsPopOverMenu","setShowAutoSubmissionsPopOverMenu","Hidden","modalState","setModalState","selectedOptionAutoSubmissions","setSelectedOptionAutoSubmissions","textFieldValueUrlSubmit","setTextFieldValueUrlSubmit","textFieldValueApiKey","setTextFieldValueApiKey","urlSubmitted","setUrlSubmitted","apiSettingsUpdated","setApiSettingsUpdated","apiKeyUpdated","setApiKeyUpdated","useEffect","CheckApiKeyValidity","GetApiSettings","GetStats","GetAllSubmissions","sort","b","submission_date","urlSubmissionTableColumns","name","fieldName","onRender","decodeURI","minWidth","time","Date","setUTCSeconds","getFullYear","format","data-submission","resubmitOnClick","maxWidth","submissionItemString","dataset","submission","submissionItem","parse","RetryFailedSubmissions","hasError","SubmissionErrors","isSubmitted","onMouseEnter","onMouseLeave","UpdateApiKeyModal","EditPrefAutoSubmissionModal","DefaultButton","SubmitUrlModal","Quota","PassedSubmissionCount","FailedSubmissionCount","map","timestamp","formatISO","submitted","blob","Blob","link","document","createElement","URL","createObjectURL","download","click","ShimmeredDetailsList","setKey","items","columns","selectionMode","SelectionMode","none","enableShimmer","undefined","ariaLabelForShimmer","ariaLabelForGrid","listProps","renderedWindowsAhead","renderedWindowsBehind","onRenderCheckbox","checked","val","ChoiceGroup","selectedKey","options","option","UpdateAutoSubmissionsEnabled","trim","SubmitUrl","App","hasAPIKey","setHasAPIKey","bannerList","setBannerList","GetApiKey","notification","concat","slice","closeBannerOnClick","bannerIndexString","index","temp","splice","parseInt","bannerItem","indexOf","data-index","Boolean","location","hostname","match","initializeIcons","rootElement","getElementById","ReactDOM","render","StrictMode","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.0729d398.chunk.js","sourcesContent":["export const ErrorConstants = {\r\n    NoDataFound: {\r\n      Code: \"NoDataFound\",\r\n      Message: \"No data available\"\r\n    },\r\n\r\n    RequestTimedOut: {\r\n      HttpStatusCode: 408,\r\n      Code: \"RequestTimedOut\",\r\n      Message:\r\n        \"This might be a momentary issue, please try again or check back later\"\r\n    },\r\n\r\n    UrlNotAllowed: {\r\n      Code: \"UrlNotAllowed\",\r\n      Message:\r\n        \"We found that the URL submitted for block is important for Bing users and hence cannot be blocked through Bing Webmaster tools.\"\r\n    }\r\n  };\r\n","import { ErrorConstants } from \"./ErrorConstants\";\r\n\r\ndeclare global {\r\n    interface Window { wpr_object: any; }\r\n}\r\n\r\nconst baseURL = `${window['wpr_object']['api_url']}`;\r\n\r\nexport interface IHttpResponse<T> extends Response {\r\n  data?: T;\r\n  error?: IAPIError;\r\n}\r\n\r\nexport interface IAPIError {\r\n  code: string;\r\n  message: string;\r\n  details?: IAPIErrorDetails[];\r\n}\r\n\r\nexport interface IAPIErrorDetails {\r\n  target: string;\r\n  message: string;\r\n}\r\n\r\nconst nonceHeader = {\r\n  headers: {\r\n    \"X-WP-Nonce\": `${window['wpr_object']['api_nonce']}`\r\n  }\r\n};\r\n\r\nexport async function useFetch<T>(\r\n  requestUrl: RequestInfo\r\n): Promise<IHttpResponse<T>> {\r\n  return withTimeout<T>(\r\n    new Promise((resolve, reject) => {\r\n      let response: IHttpResponse<T>;\r\n      fetch(`${baseURL}${requestUrl}`, nonceHeader)\r\n        .then(res => {\r\n          response = res;\r\n          return res.json();\r\n        })\r\n        .then(body => {\r\n          if (response.ok) {\r\n            response.data = body;\r\n          } else {\r\n            response.error = body;\r\n          }\r\n          resolve(response);\r\n        })\r\n        .catch(err => {\r\n          reject(err);\r\n        });\r\n    })\r\n  );\r\n}\r\n\r\nexport async function useSubmit<T>(\r\n  requestUrl: RequestInfo,\r\n  requestData: any\r\n): Promise<IHttpResponse<T>> {\r\n  return withTimeout<T>(\r\n    new Promise((resolve, reject) => {\r\n      let response: IHttpResponse<T>;\r\n      fetch(`${baseURL}${requestUrl}`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          ...(nonceHeader.headers),\r\n          \"Accept\": \"application/json, text/javascript, */*; q=0.01\",\r\n          \"Content-Type\": \"application/json;charset=UTF-8\"\r\n        },\r\n        body: JSON.stringify(requestData)\r\n      })\r\n        .then(res => {\r\n          response = res;\r\n          return res.json();\r\n        })\r\n        .then(body => {\r\n          if (response.ok) {\r\n            response.data = body;\r\n          } else {\r\n            response.error = body;\r\n          }\r\n          resolve(response);\r\n        })\r\n        .catch(err => {\r\n          reject(err);\r\n        });\r\n    })\r\n  );\r\n}\r\n\r\nexport function withTimeout<T>(\r\n  promise: Promise<IHttpResponse<T>>,\r\n  timeout = 60000\r\n) {\r\n  let timer: ReturnType<typeof setTimeout>;\r\n  return Promise.race<IHttpResponse<T>>([\r\n    promise,\r\n    new Promise<IHttpResponse<T>>((resolve, _) => {\r\n      let response: IHttpResponse<T>;\r\n      const timeoutInit: ResponseInit = {\r\n        status: ErrorConstants.RequestTimedOut.HttpStatusCode\r\n      };\r\n      response = new Response(null, timeoutInit);\r\n      timer = setTimeout(() => {\r\n        response.error = {\r\n          code: ErrorConstants.RequestTimedOut.Code,\r\n          message: ErrorConstants.RequestTimedOut.Message\r\n        };\r\n        resolve(response);\r\n      }, timeout);\r\n    })\r\n  ]).then(result => {\r\n    clearTimeout(timer);\r\n    return result;\r\n  });\r\n}\r\n\r\nexport async function useDownload(\r\n  requestUrl: RequestInfo,\r\n  requestData: any,\r\n  callback?: () => void\r\n): Promise<IHttpResponse<void>> {\r\n  return new Promise((resolve, reject) => {\r\n    let response: any;\r\n    fetch(`${baseURL}${requestUrl}`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        ...(nonceHeader.headers),\r\n        \"Accept\": \"application/json, text/javascript, */*; q=0.01\",\r\n        \"Content-Type\": \"application/json;charset=UTF-8\"\r\n      },\r\n      body: JSON.stringify(requestData)\r\n    })\r\n      .then(res => {\r\n        response = res;\r\n        return res.blob();\r\n      })\r\n      .then(blob => {\r\n        const url: string = window.URL.createObjectURL(blob);\r\n        const a: HTMLAnchorElement = document.createElement(\"a\");\r\n        a.href = url;\r\n        a.download = response.headers\r\n          .get(\"content-disposition\")\r\n          .split(\"filename=\")[1];\r\n        document.body.appendChild(a); // we need to append the element to the dom -> otherwise it will not work in firefox\r\n        a.click();\r\n        resolve(response);\r\n        setTimeout(() => {\r\n          a.remove(); // afterwards we remove the element again\r\n        }, 100);\r\n        if (callback) {\r\n          callback();\r\n        }\r\n      })\r\n      .catch(err => {\r\n        reject(err);\r\n      });\r\n  });\r\n}\r\n","import { IHttpResponse, useFetch, useSubmit } from \"./APIHelper\";\r\nimport {\r\n  ISetApiKeyRequest,\r\n  IGetApiSettingsResponse,\r\n  IGetStatsResponse,\r\n  IGetAllSubmissionsResponse,\r\n  ISubmitUrlResponse,\r\n  ISubmitUrlRequest,\r\n  IGetApiKeyResponse,\r\n  ISetApiKeyResponse,\r\n  IRetryFailedSubmissionsResponse,\r\n  IRetryFailedSubmissionsRequest,\r\n  ISetAutoSubmissionEnabledResponse,\r\n  ISetAutoSubmissionEnabledRequest,\r\n  ICheckApiKeyValidityResponse,\r\n  UrlSubmission,\r\n} from \"./Interfaces\";\r\n\r\nexport async function GetApiKey() {\r\n  let response: IHttpResponse<IGetApiKeyResponse>;\r\n  const url = `apiKey`;\r\n  response = await useFetch<IGetApiKeyResponse>(url).catch((err) => {\r\n    console.error(\"Error while fetching API key.\");\r\n    return err;\r\n  });\r\n  return response;\r\n}\r\n\r\nexport async function SetApiKey(apiKey: string) {\r\n  let response: IHttpResponse<ISetApiKeyResponse>;\r\n  const url = `apiKey`;\r\n  const apiContent: ISetApiKeyRequest = {\r\n    APIKey: apiKey,\r\n  };\r\n  response = await useSubmit<ISetApiKeyResponse>(url, apiContent).catch(\r\n    (err) => {\r\n      console.error(\"Error while updating API key.\");\r\n      return err;\r\n    }\r\n  );\r\n  return response;\r\n}\r\n\r\nexport async function CheckApiKeyValidity() {\r\n  let response: IHttpResponse<ICheckApiKeyValidityResponse>;\r\n  const url = `apiKeyValidity`;\r\n  response = await useFetch<ICheckApiKeyValidityResponse>(url).catch((err) => {\r\n    console.error(\"Error while checking API key validity.\");\r\n    return err;\r\n  });\r\n  return response;\r\n}\r\n\r\nexport async function GetApiSettings() {\r\n  let response: IHttpResponse<IGetApiSettingsResponse>;\r\n  const url = `apiSettings`;\r\n  response = await useFetch<IGetApiSettingsResponse>(url).catch((err) => {\r\n    console.error(\"Error while fetching plugin settings.\");\r\n    return err;\r\n  });\r\n  return response;\r\n}\r\n\r\nexport async function GetStats() {\r\n  let response: IHttpResponse<IGetStatsResponse>;\r\n  const url = `getStats`;\r\n  response = await useFetch<IGetStatsResponse>(url).catch((err) => {\r\n    console.error(\"Error while fetching submission statistics.\");\r\n    return err;\r\n  });\r\n  return response;\r\n}\r\n\r\nexport async function GetAllSubmissions() {\r\n  let response: IHttpResponse<IGetAllSubmissionsResponse>;\r\n  const url = `allSubmissions`;\r\n  response = await useFetch<IGetAllSubmissionsResponse>(url).catch((err) => {\r\n    console.error(\"Error while fetching submitted URLs list.\");\r\n    return err;\r\n  });\r\n  return response;\r\n}\r\n\r\nexport async function RetryFailedSubmissions(\r\n  failedSubmissions: UrlSubmission[]\r\n) {\r\n  const param: IRetryFailedSubmissionsRequest = {\r\n    Submissions: failedSubmissions,\r\n  };\r\n  let response: IHttpResponse<IRetryFailedSubmissionsResponse>;\r\n  const url = `allSubmissions`;\r\n  response = await useSubmit<IRetryFailedSubmissionsResponse>(url, param).catch(\r\n    (err) => {\r\n      console.error(\"Error while retrying failed submissions.\");\r\n      return err;\r\n    }\r\n  );\r\n  return response;\r\n}\r\n\r\nexport async function UpdateAutoSubmissionsEnabled(isEnabled: boolean) {\r\n  const param: ISetAutoSubmissionEnabledRequest = {\r\n    AutoSubmissionEnabled: isEnabled,\r\n  };\r\n  let response: IHttpResponse<ISetAutoSubmissionEnabledResponse>;\r\n  const url = `automaticSubmission`;\r\n  response = await useSubmit<ISetAutoSubmissionEnabledResponse>(\r\n    url,\r\n    param\r\n  ).catch((err) => {\r\n    console.error(\"Error while updating automatic submission settings.\");\r\n    return err;\r\n  });\r\n  return response;\r\n}\r\n\r\nexport async function SubmitUrl(url: string) {\r\n  let response: IHttpResponse<ISubmitUrlResponse>;\r\n  const ep = `submitUrl`;\r\n  const apiContent: ISubmitUrlRequest = {\r\n    url: url,\r\n  };\r\n  response = await useSubmit<ISubmitUrlResponse>(ep, apiContent).catch(\r\n    (err) => {\r\n      console.error(\"Error while submitting URL.\");\r\n      return err;\r\n    }\r\n  );\r\n  return response;\r\n}\r\n","export class StringConstants {\r\n  static readonly ApiKeyHelpLink =\r\n    \"https://docs.microsoft.com/en-us/bingwebmaster/getting-access#using-api-key\";\r\n  static readonly BingWebmasterLink = \"https://bing.com/webmaster\";\r\n  static readonly PluginInfoLink = \"https://aka.ms/BingWordpressPluginAbout\";\r\n  static readonly ApiKeyValidationError =\r\n    \"Invalid API key! (Should be alphanumeric and 32 characters in length.)\";\r\n  // static readonly domain = \"example.com\";\r\n  static readonly UrlSubmitErrorMessage = \"Invalid URL!\";\r\n}\r\n\r\nexport const ApiKeyRegex = RegExp(\"^[a-zA-Z0-9]{0,32}$\");\r\n// eslint-disable-next-line no-useless-escape\r\n// export const urlRegex = RegExp(`^(?:http(s)?:\\/\\/)?[\\w.-]+(?:\\.(${url})+)+[/\\w.\\S]*$`);\r\n\r\n// eslint-disable-next-line no-useless-escape\r\nexport const SubmitUrlRegex = RegExp(\r\n  `^https?:\\\\/\\\\/(www\\\\.)?[-a-zA-Z0-9@:%._\\\\+~#=]{1,256}\\\\.[a-zA-Z0-9()]{1,6}\\\\b([-a-zA-Z0-9()@:%_\\\\+.~#?&//=]*)$`\r\n);\r\n","import \"../scss/Header.scss\";\r\n\r\nimport * as React from \"react\";\r\nimport { Icon } from \"@fluentui/react/lib/Icon\";\r\nimport { StringConstants } from \"../Constants\";\r\n\r\nconst logosvg = (\r\n  <svg\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    width=\"52.793\"\r\n    height=\"21.328\"\r\n    viewBox=\"0 0 52.793 21.328\"\r\n  >\r\n    <g fill=\"#fff\" transform=\"translate(311.5 -796.169)\">\r\n      <path d=\"M-311.5,796.169l4.261,1.5v15l6-3.464-2.942-1.38-1.856-4.62,9.456,3.322v4.83l-10.656,6.146-4.263-2.371Z\" />\r\n      <g transform=\"translate(-290.183 800.152)\">\r\n        <path\r\n          d=\"M2708.543,12811.441v-12.808h3.644a3.981,3.981,0,0,1,2.634.813,2.626,2.626,0,0,1,.974,2.116,3.115,3.115,0,0,1-.59,1.894,3.163,3.163,0,0,1-1.625,1.142v.037a3.26,3.26,0,0,1,2.072.978,3.011,3.011,0,0,1,.777,2.148,3.349,3.349,0,0,1-1.179,2.661,4.388,4.388,0,0,1-2.974,1.019Zm1.5-11.45v4.136h1.536a2.919,2.919,0,0,0,1.938-.594,2.07,2.07,0,0,0,.706-1.675q0-1.868-2.456-1.867Zm0,5.483v4.608h2.036a3.049,3.049,0,0,0,2.05-.625,2.139,2.139,0,0,0,.728-1.714q0-2.268-3.09-2.27Z\"\r\n          transform=\"translate(-2708.543 -12798.358)\"\r\n        />\r\n        <path\r\n          d=\"M2891.153,12795.346a.93.93,0,0,1-.669-.268.907.907,0,0,1-.277-.68.937.937,0,0,1,.947-.955.946.946,0,0,1,.684.271.955.955,0,0,1,0,1.354A.935.935,0,0,1,2891.153,12795.346Zm.715,11.179H2890.4v-9.076h1.465Z\"\r\n          transform=\"translate(-2880.606 -12793.443)\"\r\n        />\r\n        <path\r\n          d=\"M2974.872,12874.426h-1.464v-5.147c0-1.941-.654-2.912-2.071-2.912a2.306,2.306,0,0,0-1.818.826,3.061,3.061,0,0,0-.719,2.086v5.147h-1.465v-9.074h1.465v1.485h.036a3.234,3.234,0,0,1,2.946-1.7,2.8,2.8,0,0,1,2.3.97,4.314,4.314,0,0,1,.795,2.8Z\"\r\n          transform=\"translate(-2953.66 -12861.346)\"\r\n        />\r\n        <path\r\n          d=\"M3154.274,12873.6q0,5.038-4.822,5.038a6.237,6.237,0,0,1-2.909-.63l.384-1.255a4.883,4.883,0,0,0,2.508.658c2.25,0,3.375-1.175,3.375-3.567v-.991h-.036a3.308,3.308,0,0,1-3.077,1.735,3.378,3.378,0,0,1-2.746-1.156,4.864,4.864,0,0,1-1.041-3.271,5.7,5.7,0,0,1,1.121-3.708,3.747,3.747,0,0,1,3.068-1.375,2.877,2.877,0,0,1,2.675,1.483h.036v-1.264h1.465Zm-1.465-3.359v-1.277a2.613,2.613,0,0,0-.737-1.865,2.331,2.331,0,0,0-1.793-.778,2.542,2.542,0,0,0-2.125.987,4.4,4.4,0,0,0-.768,2.764,3.573,3.573,0,0,0,.737,2.37,2.379,2.379,0,0,0,1.951.914,2.464,2.464,0,0,0,1.963-.874A3.262,3.262,0,0,0,3152.809,12870.236Z\"\r\n          transform=\"translate(-3122.798 -12861.29)\"\r\n        />\r\n      </g>\r\n    </g>\r\n  </svg>\r\n);\r\n\r\nconst mobileLogoSvg = (\r\n  <svg\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    width=\"14.92\"\r\n    height=\"21.328\"\r\n    viewBox=\"0 0 14.92 21.328\"\r\n  >\r\n    <g fill=\"#fff\" transform=\"translate(311.5 -796.169)\">\r\n      <path d=\"M-311.5,796.169l4.261,1.5v15l6-3.464-2.942-1.38-1.856-4.62,9.456,3.322v4.83l-10.656,6.146-4.263-2.371Z\" />\r\n    </g>\r\n  </svg>\r\n);\r\n\r\ninterface IRightPanel {\r\n  title: string;\r\n}\r\n\r\nexport const Header: React.FunctionComponent = () => {\r\n\r\n  return (\r\n    <>\r\n      <header className=\"bw-Header\">\r\n        <div className=\"headerLeftElements floatLeft\">\r\n          <span className=\"bingLogo desktopOnly\">{logosvg}</span>\r\n          <span className=\"bingLogoMobile mobileOnly\">{mobileLogoSvg}</span>\r\n          <span className=\"pageTitle\">\r\n            URL Submission plugin\r\n          </span>\r\n        </div>\r\n        <div className=\"headerRightElements floatRight\">\r\n          <span\r\n            title=\"Help\"\r\n            onClick={() =>\r\n              window.open(StringConstants.PluginInfoLink, \"_blank\")\r\n            }\r\n            key=\"headerHelp\"\r\n          >\r\n            <span className=\"desktopOnly\">About this plugin</span>\r\n            <Icon iconName=\"Info\" className=\"bw-Icon\" />\r\n          </span>\r\n        </div>\r\n      </header>\r\n    </>\r\n  );\r\n};\r\n","import \"../scss/StartPage.scss\";\r\n\r\nimport * as React from \"react\";\r\nimport { useState } from \"react\";\r\nimport { PrimaryButton } from \"@fluentui/react/lib/Button\";\r\nimport { Icon } from \"@fluentui/react/lib/Icon\";\r\nimport { TextField } from \"@fluentui/react/lib/TextField\";\r\nimport { SetApiKey } from \"./withDashboardData\";\r\nimport { ApiKeyRegex, StringConstants } from \"../Constants\";\r\n\r\ninterface IStartPage {\r\n  addBanner: (str: string) => void;\r\n  setAPIKeyAdded: () => void;\r\n}\r\n\r\nexport const StartPage: React.FunctionComponent<IStartPage> = (props) => {\r\n  const [apiKey, setApiKey] = useState(\"\");\r\n\r\n  const onSubmitApiKey = (): void => {\r\n    Promise.resolve(SetApiKey(apiKey)).then((response) => {\r\n      if (response?.data?.error_type.length === 0) {\r\n        props.setAPIKeyAdded();\r\n      } else {\r\n        props.addBanner(`Adding API key failed: ${response.data?.error_type}`);\r\n      }\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"bw-StartPageContent\">\r\n      <div className=\"featuresSection\">\r\n        <h2 className=\"inlineText\">What you can do with this plugin</h2>\r\n\r\n        <div className=\"featuresListContainer\">\r\n          <div className=\"featureItem\">\r\n            <Icon iconName=\"Rocket\" className=\"featureIcon\" />\r\n            <p>Automate URL submissions</p>\r\n          </div>\r\n          <div className=\"featureItem\">\r\n            <Icon iconName=\"Send\" className=\"featureIcon\" />\r\n            <p>Manual URL submissions</p>\r\n          </div>\r\n          <div className=\"featureItem\">\r\n            <Icon iconName=\"NumberField\" className=\"featureIcon\" />\r\n            <p>View stats of submitted URLs</p>\r\n          </div>\r\n          <div className=\"featureItem\">\r\n            <Icon iconName=\"ErrorBadge\" className=\"featureIcon\" />\r\n            <p>View recent submissions</p>\r\n          </div>\r\n          <div className=\"featureItem\">\r\n            <Icon iconName=\"BulletedList\" className=\"featureIcon\" />\r\n            <p>Re-submit recent submissions</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"keyEntrySection\">\r\n        <div className=\"keyEntryCard\">\r\n          <h3>Add API Key To Get Started</h3>\r\n          <p>\r\n            Add valid API key and automate URL submission by clicking on Start\r\n            using this plugin. You can disable auto submission later from plugin\r\n            if needed.\r\n          </p>\r\n          <TextField\r\n            type=\"password\"\r\n            className=\"apiKeyTextField\"\r\n            value={apiKey}\r\n            onChange={(event, item) => {\r\n              setApiKey(item || \"\");\r\n            }}\r\n            placeholder=\"Enter 32 digit API key\"\r\n            validateOnLoad={false}\r\n            onGetErrorMessage={() => {\r\n              return !ApiKeyRegex.test(apiKey) || apiKey.length !== 32\r\n                ? StringConstants.ApiKeyValidationError\r\n                : \"\";\r\n            }}\r\n          />\r\n          <p>\r\n            Don\"t have API key?{\" \"}\r\n            <a href={StringConstants.ApiKeyHelpLink} target=\"_blank\">\r\n              Click here to know how to generate.\r\n            </a>\r\n          </p>\r\n          <div>\r\n            <PrimaryButton\r\n              className=\"button submitButton\"\r\n              text=\"Start using plugin\"\r\n              onClick={onSubmitApiKey}\r\n              disabled={!ApiKeyRegex.test(apiKey) || apiKey.length !== 32}\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { Icon } from \"@fluentui/react/lib/Icon\";\r\nimport { TooltipHost, ITooltipProps } from \"@fluentui/react\";\r\nimport { useId } from \"@uifabric/react-hooks/lib/useId\";\r\n\r\nexport interface ICardProps {\r\n  title: string;\r\n  tooltip: string;\r\n  leadingIconName: string;\r\n  className?: string;\r\n}\r\n\r\nexport const Card: React.FunctionComponent<ICardProps> = (props) => {\r\n  const tooltipId = useId(props.title);\r\n\r\n  const tooltipProps: ITooltipProps = {\r\n    onRenderContent: () => <span>{props.tooltip}</span>,\r\n  };\r\n\r\n  return (\r\n    <div className={\"bw-Card \" + props.className || \"\"}>\r\n      <div className=\"cardHeader\">\r\n        <span className=\"cardTitle\">\r\n          <Icon iconName={props.leadingIconName} className=\"cardTitleIcon\" />\r\n          <span>{props.title}</span>\r\n\r\n          <TooltipHost\r\n            closeDelay={500}\r\n            directionalHint={1}\r\n            id={tooltipId}\r\n            tooltipProps={tooltipProps}\r\n          >\r\n            <Icon\r\n              aria-describedby={tooltipId}\r\n              iconName=\"Info\"\r\n              className=\"info\"\r\n            />\r\n          </TooltipHost>\r\n        </span>\r\n      </div>\r\n      <div className=\"cardContent\">\r\n        {props.children}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import \"../scss/Dashboard.scss\";\r\n\r\nimport * as React from \"react\";\r\nimport { useState, useEffect } from \"react\";\r\nimport { DefaultButton, PrimaryButton } from \"@fluentui/react/lib/Button\";\r\nimport { Icon } from \"@fluentui/react/lib/Icon\";\r\nimport {\r\n  GetApiSettings,\r\n  GetStats,\r\n  GetAllSubmissions,\r\n  RetryFailedSubmissions,\r\n  SubmitUrl,\r\n  UpdateAutoSubmissionsEnabled,\r\n  SetApiKey,\r\n  CheckApiKeyValidity,\r\n} from \"./withDashboardData\";\r\nimport { ShimmeredDetailsList } from \"@fluentui/react/lib/ShimmeredDetailsList\";\r\nimport {\r\n  IColumn,\r\n  SelectionMode,\r\n  IChoiceGroupOption,\r\n  ChoiceGroup,\r\n  TextField,\r\n} from \"@fluentui/react/lib/index\";\r\nimport { format, formatISO } from \"date-fns\";\r\nimport {\r\n  IGetStatsResponse,\r\n  IGetApiSettingsResponse,\r\n  IGetAllSubmissionsResponse,\r\n  UrlSubmission,\r\n} from \"./Interfaces\";\r\nimport { Card } from \"./Card\";\r\nimport { StringConstants, ApiKeyRegex, SubmitUrlRegex } from \"../Constants\";\r\n\r\ninterface IDashboardProps {\r\n  addBanner: (str: string) => void;\r\n}\r\n\r\nexport const Dashboard: React.FunctionComponent<IDashboardProps> = (props) => {\r\n  enum DashboardModalState {\r\n    Hidden = 0,\r\n    UpdateApiKeyModal = 1,\r\n    EditPrefAutoSubmissionModal = 2,\r\n    SubmitUrlModal = 3,\r\n  }\r\n\r\n  const [apiKeyInvalid, setApiKeyInvalid] = useState<boolean>(false);\r\n  const [apiSettings, setAPISettings] = useState<IGetApiSettingsResponse>();\r\n  const [submissionStats, setSubmissionStats] = useState<IGetStatsResponse>();\r\n  const [submissionsList, setSubmissionsList] = useState<\r\n    IGetAllSubmissionsResponse\r\n  >();\r\n\r\n  // variables to store flyout menu states\r\n  const [showApiKeyPopOverMenu, setShowApiKeyPopOverMenu] = useState<boolean>(\r\n    false\r\n  );\r\n  const [\r\n    showAutoSubmissionsPopOverMenu,\r\n    setShowAutoSubmissionsPopOverMenu,\r\n  ] = useState<boolean>();\r\n\r\n  // variable to control modal display state\r\n  const [modalState, setModalState] = useState<DashboardModalState>(\r\n    DashboardModalState.Hidden\r\n  );\r\n\r\n  // variables storing modal UI controls state\r\n  const [\r\n    selectedOptionAutoSubmissions,\r\n    setSelectedOptionAutoSubmissions,\r\n  ] = useState<string>(\"enable\");\r\n  const [textFieldValueUrlSubmit, setTextFieldValueUrlSubmit] = useState<\r\n    string\r\n  >(\"\");\r\n  const [textFieldValueApiKey, setTextFieldValueApiKey] = useState<string>(\"\");\r\n\r\n  // variables to trigger UI data refresh\r\n  const [urlSubmitted, setUrlSubmitted] = useState<number>(0);\r\n  const [apiSettingsUpdated, setApiSettingsUpdated] = useState<number>(0);\r\n  const [apiKeyUpdated, setApiKeyUpdated] = useState<number>(0);\r\n\r\n  // Check if API key is valid\r\n  useEffect(() => {\r\n    Promise.resolve(CheckApiKeyValidity()).then((response) => {\r\n      if (response && response.data) {\r\n        if (response.data.error_type.length !== 0) {\r\n          props.addBanner(\r\n            \"API Key Validation Error: Please check if site is verified or API key is valid to enable Automatic & Manual URL submission.\"\r\n          );\r\n          setApiKeyInvalid(true);\r\n        }\r\n      }\r\n    });\r\n  }, []);\r\n\r\n  // Get API settings\r\n  useEffect(() => {\r\n    Promise.resolve(GetApiSettings()).then((response) => {\r\n      if (response && response.data && response.data.error_type.length === 0) {\r\n        setAPISettings(response.data);\r\n        setSelectedOptionAutoSubmissions(\r\n          response.data.AutoSubmissionEnabled ? \"enable\" : \"disable\"\r\n        );\r\n      }\r\n    });\r\n  }, [apiKeyUpdated, apiSettingsUpdated]);\r\n\r\n  // Get submissions statistics\r\n  useEffect(() => {\r\n    Promise.resolve(GetStats()).then((response) => {\r\n      if (response && response.data && response.data.error_type.length === 0) {\r\n        setSubmissionStats(response.data);\r\n      }\r\n    });\r\n  }, [apiKeyUpdated, urlSubmitted]);\r\n\r\n  // Get submissions list\r\n  useEffect(() => {\r\n    Promise.resolve(GetAllSubmissions()).then((response) => {\r\n      if (response && response.data && response.data.error_type.length === 0) {\r\n        response.data.Submissions.sort((a, b) =>\r\n          a.submission_date > b.submission_date ? -1 : 1\r\n        );\r\n        setSubmissionsList(response.data);\r\n      }\r\n    });\r\n  }, [apiKeyUpdated, urlSubmitted]);\r\n\r\n  // constants\r\n  const autoSubmissionOptions: IChoiceGroupOption[] = [\r\n    { key: \"enable\", text: \"Enable (recommended)\" },\r\n    { key: \"disable\", text: \"Disable\" },\r\n  ];\r\n  const urlSubmissionTableColumns: IColumn[] = [\r\n    {\r\n      key: \"url\",\r\n      name: \"URL\",\r\n      fieldName: \"url\",\r\n      onRender: (item: UrlSubmission): JSX.Element => {\r\n        return (\r\n          <a href={item.url} target=\"_blank\">\r\n            {decodeURI(item.url)}\r\n          </a>\r\n        );\r\n      },\r\n      minWidth: 250,\r\n    },\r\n    {\r\n      key: \"submittedOn\",\r\n      name: \"Submitted On\",\r\n      fieldName: \"submission_date\",\r\n      onRender: (item: UrlSubmission): string => {\r\n        let time: Date = new Date(0);\r\n        time.setUTCSeconds(item.submission_date);\r\n        let dateString: string =\r\n          time.getFullYear === new Date().getFullYear\r\n            ? format(time, \"d MMM 'at' HH':'mm\", {})\r\n            : format(time, \"d MMM yyyy'at' HH':'mm\", {});\r\n        return dateString;\r\n      },\r\n      minWidth: 150,\r\n    },\r\n    {\r\n      key: \"status\",\r\n      name: \"Status\",\r\n      fieldName: \"error\",\r\n      onRender: (item: UrlSubmission): string => {\r\n        return item.error === \"Success\" ? item.error : `Failed - ${item.error}`;\r\n      },\r\n      minWidth: 200,\r\n    },\r\n    {\r\n      key: \"resubmit\",\r\n      name: \"\",\r\n      onRender: (item: UrlSubmission) => {\r\n        return (\r\n          <Icon\r\n            iconName=\"Sync\"\r\n            data-submission={JSON.stringify(item)}\r\n            className=\"bw-Icon retryIcon\"\r\n            onClick={resubmitOnClick}\r\n          />\r\n        );\r\n      },\r\n      minWidth: 40,\r\n      maxWidth: 70,\r\n      className: \"retryColumn\",\r\n    },\r\n  ];\r\n\r\n  // Function handler for URL submission retries\r\n  const resubmitOnClick = (\r\n    event: React.MouseEvent<HTMLElement, MouseEvent>\r\n  ) => {\r\n    const submissionItemString: string =\r\n      (event.target as HTMLInputElement).dataset.submission ?? \"\";\r\n    const submissionItem: UrlSubmission = JSON.parse(submissionItemString);\r\n    Promise.resolve(RetryFailedSubmissions([submissionItem])).then(\r\n      (response) => {\r\n        if (response && response.data) {\r\n          setUrlSubmitted(urlSubmitted + 1);\r\n          if (\r\n            !response.data.hasError &&\r\n            response.data.error_type.length === 0 &&\r\n            response.data.SubmissionErrors.length >= 1 &&\r\n            response.data.SubmissionErrors[0].isSubmitted\r\n          ) {\r\n            // add new success banner\r\n            props.addBanner(\"Success : URL submitted successfully.\");\r\n          } else {\r\n            // set failed banner\r\n            props.addBanner(\r\n              `Error : Submission failed for URL - ${submissionItem.url}`\r\n            );\r\n          }\r\n        }\r\n      }\r\n    );\r\n  };\r\n\r\n  const onClickUpdateApiKey = (\r\n    event: React.MouseEvent<HTMLElement, MouseEvent>\r\n  ) => {\r\n    setModalState(DashboardModalState.Hidden);\r\n    Promise.resolve(SetApiKey(textFieldValueApiKey)).then((response) => {\r\n      if (response && response.data) {\r\n        setApiKeyUpdated(apiKeyUpdated + 1);\r\n        if (response.data.error_type.length === 0) {\r\n          props.addBanner(\"Success : API key is updated successfully.\");\r\n        } else {\r\n          props.addBanner(\"Error : Unable to update API key.\");\r\n        }\r\n      }\r\n    });\r\n  };\r\n\r\n  const onClickUpdateAutoSubmissions = (\r\n    event: React.MouseEvent<HTMLElement, MouseEvent>\r\n  ) => {\r\n    setModalState(DashboardModalState.Hidden);\r\n    Promise.resolve(\r\n      UpdateAutoSubmissionsEnabled(selectedOptionAutoSubmissions === \"enable\")\r\n    ).then((response) => {\r\n      if (response && response.data) {\r\n        setApiSettingsUpdated(apiSettingsUpdated + 1);\r\n        if (response.data.error_type.length === 0) {\r\n          props.addBanner(\r\n            \"Success : Automatic URL submission preferences updated.\"\r\n          );\r\n        } else {\r\n          props.addBanner(\r\n            \"Error : Automatic URL submission preferences not updated.\"\r\n          );\r\n        }\r\n      }\r\n    });\r\n  };\r\n\r\n  const onClickModalSubmitUrl = (\r\n    event: React.MouseEvent<HTMLElement, MouseEvent>\r\n  ) => {\r\n    // hide modal and submit Url\r\n    setModalState(DashboardModalState.Hidden);\r\n    Promise.resolve(SubmitUrl(textFieldValueUrlSubmit)).then((response) => {\r\n      if (response && response.data) {\r\n        setUrlSubmitted(urlSubmitted + 1);\r\n        if (response.data.error.length === 0) {\r\n          // add new success banner\r\n          props.addBanner(\"Success : URL submitted successfully.\");\r\n        } else {\r\n          // set failed banner\r\n          props.addBanner(\r\n            `Error : Submission failed for URL - ${textFieldValueUrlSubmit}`\r\n          );\r\n        }\r\n      }\r\n    });\r\n  };\r\n\r\n  const downloadUrls = () => {\r\n    let data = submissionsList?.Submissions?.map((item) => {\r\n      let timestamp: Date = new Date(0);\r\n      timestamp.setUTCSeconds(item.submission_date);\r\n      return {\r\n        url: item.url,\r\n        timestamp: formatISO(timestamp),\r\n        submitted: item.error === \"Success\",\r\n        status: item.error,\r\n      };\r\n    });\r\n    const json = JSON.stringify(data);\r\n    const blob = new Blob([json], { type: \"application/json\" });\r\n    const link = document.createElement(\"a\");\r\n    link.href = URL.createObjectURL(blob);\r\n    link.download = \"submissionslist.json\";\r\n    link.click();\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div\r\n        className={\r\n          \"bw-DashboardContent\" +\r\n          (modalState !== DashboardModalState.Hidden ? \" darken\" : \"\")\r\n        }\r\n      >\r\n        <div className=\"bw-CardRow\">\r\n          <div className=\"bw-CardColumn bw-CardColumn-2 bw-ApiKeyCard\">\r\n            <Card\r\n              title=\"API Key\"\r\n              tooltip=\"API Key is a unique identifier that is used to authenticate API requests.\"\r\n              leadingIconName=\"Permissions\"\r\n              className=\"bw-Card-WithPopOver\"\r\n            >\r\n              <p className=\"cardDescription\">\r\n                ********************************\r\n              </p>\r\n            </Card>\r\n            <div\r\n              className=\"bw-PopOverMenu\"\r\n              onMouseEnter={() => {\r\n                setShowApiKeyPopOverMenu(true);\r\n              }}\r\n              onMouseLeave={() => {\r\n                setShowApiKeyPopOverMenu(false);\r\n              }}\r\n            >\r\n              <Icon iconName=\"MoreVertical\" className=\"moreIcon\" />\r\n              <div className=\"popOverContainer\">\r\n                <ul\r\n                  className={\r\n                    \"popOverPanel\" +\r\n                    (showApiKeyPopOverMenu ? \" openPopOverMenu\" : \"\")\r\n                  }\r\n                >\r\n                  <li\r\n                    onClick={() => {\r\n                      // reset UI controls and display modal\r\n                      setTextFieldValueApiKey(\"\");\r\n                      setModalState(DashboardModalState.UpdateApiKeyModal);\r\n                    }}\r\n                  >\r\n                    Update key\r\n                  </li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bw-CardColumn bw-CardColumn-2\">\r\n            <Card\r\n              title=\"Automate URL submission\"\r\n              className={\r\n                \"bw-Card-WithPopOver \" + (apiKeyInvalid ? \"bw-Disabled\" : \"\")\r\n              }\r\n              tooltip=\"This feature allows to configure automation to submit new, updated & deleted URLs to Bing and stay updated.\"\r\n              leadingIconName=\"Rocket\"\r\n            >\r\n              <p className=\"cardDescription\">\r\n                {apiSettings\r\n                  ? apiSettings.AutoSubmissionEnabled\r\n                    ? \"Enabled\"\r\n                    : \"Disabled\"\r\n                  : \"-\"}\r\n              </p>\r\n            </Card>\r\n            <div\r\n              className={\r\n                \"bw-PopOverMenu \" + (apiKeyInvalid ? \"bw-Disabled\" : \"\")\r\n              }\r\n              onMouseEnter={() => {\r\n                // don't show popover menu if API key is invalid\r\n                !apiKeyInvalid && setShowAutoSubmissionsPopOverMenu(true);\r\n              }}\r\n              onMouseLeave={() => {\r\n                setShowAutoSubmissionsPopOverMenu(false);\r\n              }}\r\n            >\r\n              <Icon iconName=\"MoreVertical\" className=\"moreIcon\" />\r\n              <div className=\"popOverContainer\">\r\n                <ul\r\n                  className={\r\n                    \"popOverPanel\" +\r\n                    (showAutoSubmissionsPopOverMenu ? \" openPopOverMenu\" : \"\")\r\n                  }\r\n                >\r\n                  <li\r\n                    onClick={() => {\r\n                      // reset UI controls settings and display modal\r\n                      setSelectedOptionAutoSubmissions(\r\n                        apiSettings?.AutoSubmissionEnabled\r\n                          ? \"enable\"\r\n                          : \"disable\"\r\n                      );\r\n                      setModalState(\r\n                        DashboardModalState.EditPrefAutoSubmissionModal\r\n                      );\r\n                    }}\r\n                  >\r\n                    Edit preference\r\n                  </li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"bw-CardRow\">\r\n          <div className=\"bw-CardColumn bw-CardColumn-1 bw-ManualURLSubmissionCard\">\r\n            <Card\r\n              title=\"Manual URL submission\"\r\n              tooltip=\"This feature allows you to submit a URL directly into the Bing index.\"\r\n              leadingIconName=\"Send\"\r\n              className={apiKeyInvalid ? \"bw-Disabled\" : \"\"}\r\n            >\r\n              <p className=\"cardDescription\">\r\n                This feature allows you to submit a URL directly into the Bing\r\n                index.\r\n              </p>\r\n              <DefaultButton\r\n                disabled={apiKeyInvalid}\r\n                onClick={() => {\r\n                  // reset UI controls and display modal\r\n                  setTextFieldValueUrlSubmit(\"\");\r\n                  setModalState(DashboardModalState.SubmitUrlModal);\r\n                }}\r\n                className=\"buttonSubmitUrl\"\r\n                text=\"Submit URL\"\r\n              />\r\n            </Card>\r\n          </div>\r\n        </div>\r\n\r\n        <h2 className=\"sectionTitle\">Overview</h2>\r\n        <div className=\"bw-CardRow\">\r\n          <div className=\"bw-OverviewSection\">\r\n            <div className=\"infoCards\">\r\n              <h4>Quota left for the day</h4>\r\n              <h2>\r\n                {submissionStats && submissionStats.Quota !== null\r\n                  ? submissionStats.Quota\r\n                  : \"-\"}\r\n              </h2>\r\n              <p>(Resets at 00:00 GMT)</p>\r\n            </div>\r\n            <div className=\"infoCards\">\r\n              <h4>Successful submissions</h4>\r\n              <h2>\r\n                {submissionStats &&\r\n                submissionStats.PassedSubmissionCount !== null\r\n                  ? submissionStats.PassedSubmissionCount\r\n                  : \"-\"}\r\n              </h2>\r\n              <p>In last 48 hours</p>\r\n            </div>\r\n            <div className=\"infoCards\">\r\n              <h4>Failed submissions</h4>\r\n              <h2>\r\n                {submissionStats &&\r\n                submissionStats.FailedSubmissionCount !== null\r\n                  ? submissionStats.FailedSubmissionCount\r\n                  : \"-\"}\r\n              </h2>\r\n              <p>In last 48 hours</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"sectionTitleContainer\">\r\n          <h2 className=\"sectionTitle\">URLs submitted</h2>\r\n          <DefaultButton\r\n            disabled={\r\n              submissionsList?.Submissions === null ||\r\n              submissionsList?.Submissions.length === 0\r\n            }\r\n            onClick={downloadUrls}\r\n            className=\"buttonUrlSubmissionsDownload\"\r\n            text=\"Download\"\r\n          />\r\n        </div>\r\n        <div className=\"bw-CardRow\">\r\n          <div className=\"bw-CardColumn bw-CardColumn-1 bw-UrlSubmissions\">\r\n            <ShimmeredDetailsList\r\n              setKey=\"items\"\r\n              items={submissionsList?.Submissions ?? []}\r\n              columns={urlSubmissionTableColumns}\r\n              selectionMode={SelectionMode.none}\r\n              enableShimmer={submissionsList === undefined}\r\n              ariaLabelForShimmer=\"Content is being fetched\"\r\n              ariaLabelForGrid=\"Item details\"\r\n              listProps={{ renderedWindowsAhead: 0, renderedWindowsBehind: 0 }}\r\n              onRenderCheckbox={(props) => {\r\n                return props?.checked ? (\r\n                  <Icon iconName=\"CheckboxComposite\" className=\"\" />\r\n                ) : (\r\n                  <Icon iconName=\"Checkbox\" className=\"\" />\r\n                );\r\n              }}\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"footnotes\">\r\n          <p className=\"footnotes\">\r\n            Maximum of 20 successful and 20 failed submissions in last 48hrs\r\n            will be displayed.\r\n          </p>\r\n          <p>\r\n            For more information, login to{\" \"}\r\n            <a href={StringConstants.BingWebmasterLink}>Bing Webmaster Tools</a>\r\n            .\r\n          </p>\r\n        </div>\r\n      </div>\r\n      <div\r\n        className={\r\n          \"bw-Modal\" +\r\n          (modalState !== DashboardModalState.Hidden ? \" showModal\" : \"\")\r\n        }\r\n      >\r\n        {modalState === DashboardModalState.UpdateApiKeyModal && (\r\n          <div className={\"modalContainer bw-ModalUpdateApiKey\"}>\r\n            <div className=\"modalHeader\">\r\n              <p className=\"modalTitle\">Update API Key</p>\r\n              <Icon\r\n                iconName=\"ChromeClose\"\r\n                className=\"bw-Icon modalClose\"\r\n                onClick={() => {\r\n                  setModalState(DashboardModalState.Hidden);\r\n                }}\r\n              />\r\n            </div>\r\n            <div className=\"modalContent\">\r\n              <TextField\r\n                placeholder=\"Enter 32 digit API key\"\r\n                className=\"textField\"\r\n                value={textFieldValueApiKey}\r\n                onChange={(event, val) => {\r\n                  setTextFieldValueApiKey(val || \"\");\r\n                }}\r\n                validateOnLoad={false}\r\n                onGetErrorMessage={() => {\r\n                  return !ApiKeyRegex.test(textFieldValueApiKey) ||\r\n                    textFieldValueApiKey.length !== 32\r\n                    ? StringConstants.ApiKeyValidationError\r\n                    : \"\";\r\n                }}\r\n              />\r\n              <p>\r\n                Don’t have API key?{\" \"}\r\n                <a href={StringConstants.ApiKeyHelpLink}>\r\n                  Click here to know how to generate.\r\n                </a>\r\n              </p>\r\n            </div>\r\n            <div className=\"modalFooter\">\r\n              <PrimaryButton\r\n                className=\"button primaryButton\"\r\n                text=\"Update\"\r\n                onClick={onClickUpdateApiKey}\r\n                disabled={\r\n                  !ApiKeyRegex.test(textFieldValueApiKey) ||\r\n                  textFieldValueApiKey.length !== 32\r\n                }\r\n              />\r\n              <DefaultButton\r\n                className=\"button secondaryButton\"\r\n                text=\"Cancel\"\r\n                onClick={() => {\r\n                  setModalState(DashboardModalState.Hidden);\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n        )}\r\n        {modalState === DashboardModalState.EditPrefAutoSubmissionModal && (\r\n          <div className=\"modalContainer bw-ModalEditPreferenceAutoSubmissions\">\r\n            <div className=\"modalHeader\">\r\n              <p className=\"modalTitle\">\r\n                Edit preference for Automate URL Submission\r\n              </p>\r\n              <Icon\r\n                iconName=\"ChromeClose\"\r\n                className=\"bw-Icon modalClose\"\r\n                onClick={() => {\r\n                  setModalState(DashboardModalState.Hidden);\r\n                }}\r\n              />\r\n            </div>\r\n            <div className=\"modalContent\">\r\n              <p className=\"modalDescription\">\r\n                We recommend you to enable automation to submit new, updated &\r\n                deleted URLs to Bing and stay updated.\r\n              </p>\r\n              <ChoiceGroup\r\n                selectedKey={selectedOptionAutoSubmissions}\r\n                options={autoSubmissionOptions}\r\n                onChange={(event, option) => {\r\n                  if (option !== undefined) {\r\n                    setSelectedOptionAutoSubmissions(option.key);\r\n                  }\r\n                }}\r\n              />\r\n            </div>\r\n            <div className=\"modalFooter\">\r\n              <PrimaryButton\r\n                className=\"button primaryButton\"\r\n                text=\"Save\"\r\n                onClick={onClickUpdateAutoSubmissions}\r\n                disabled={\r\n                  (apiSettings?.AutoSubmissionEnabled\r\n                    ? \"enable\"\r\n                    : \"disable\") === selectedOptionAutoSubmissions\r\n                }\r\n              />\r\n              <DefaultButton\r\n                className=\"button secondaryButton\"\r\n                text=\"Cancel\"\r\n                onClick={() => {\r\n                  setModalState(DashboardModalState.Hidden);\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {modalState === DashboardModalState.SubmitUrlModal && (\r\n          <div className=\"modalContainer bw-ModalUrlSubmit\">\r\n            <div className=\"modalHeader\">\r\n              <p className=\"modalTitle\">Manual URL submission</p>\r\n              <Icon\r\n                iconName=\"ChromeClose\"\r\n                className=\"bw-Icon modalClose\"\r\n                onClick={() => {\r\n                  setModalState(DashboardModalState.Hidden);\r\n                }}\r\n              />\r\n            </div>\r\n            <div className=\"modalContent\">\r\n              <TextField\r\n                placeholder=\"Enter URL to submit\"\r\n                className=\"textField\"\r\n                value={textFieldValueUrlSubmit}\r\n                validateOnLoad={false}\r\n                onGetErrorMessage={() => {\r\n                  return !SubmitUrlRegex.test(textFieldValueUrlSubmit)\r\n                    ? StringConstants.UrlSubmitErrorMessage\r\n                    : \"\";\r\n                }}\r\n                onChange={(event, val) => {\r\n                  setTextFieldValueUrlSubmit(val?.trim() || \"\");\r\n                }}\r\n              />\r\n            </div>\r\n            <div className=\"modalFooter\">\r\n              <PrimaryButton\r\n                className=\"button primaryButton\"\r\n                text=\"Submit URL\"\r\n                disabled={!SubmitUrlRegex.test(textFieldValueUrlSubmit)}\r\n                onClick={onClickModalSubmitUrl}\r\n              />\r\n              <DefaultButton\r\n                className=\"button secondaryButton\"\r\n                text=\"Cancel\"\r\n                onClick={() => {\r\n                  setModalState(DashboardModalState.Hidden);\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n","import \"../scss/_common.scss\";\r\nimport \"../scss/responsiveLayout.scss\";\r\nimport \"../scss/App.scss\";\r\n\r\nimport * as React from \"react\";\r\nimport { useState, useEffect } from \"react\";\r\nimport { GetApiKey } from \"./withDashboardData\";\r\n\r\nimport { Header } from \"./Header\";\r\nimport { StartPage } from \"./StartPage\";\r\nimport { Dashboard } from \"./Dashboard\";\r\nimport { Icon } from \"@fluentui/react/lib/Icon\";\r\n\r\nexport const App: React.FunctionComponent = () => {\r\n  const [hasAPIKey, setHasAPIKey] = useState(false);\r\n\r\n  // variable to store banners\r\n  const [bannerList, setBannerList] = useState<string[]>([]);\r\n\r\n  useEffect(() => {\r\n    const data = Promise.resolve(GetApiKey());\r\n    data.then((response) => {\r\n      if (response && response.data) {\r\n        setHasAPIKey(response.data.hasAPIKey);\r\n      }\r\n    });\r\n  }, []);\r\n\r\n  // Function to add new banner notification\r\n  const addBanner = (notification: string) =>\r\n    setBannerList([notification].concat(bannerList.slice()));\r\n\r\n  // remove banner when close button is clicked\r\n  const closeBannerOnClick = (\r\n    event: React.MouseEvent<HTMLElement, MouseEvent>\r\n  ) => {\r\n    let bannerIndexString: string =\r\n      (event.target as HTMLElement).dataset.index ?? \"0\";\r\n    let temp: string[] = bannerList.slice();\r\n    temp.splice(parseInt(bannerIndexString), 1);\r\n    setBannerList(temp);\r\n  };\r\n\r\n  return (\r\n    <div className=\"bw-App\">\r\n      <Header />\r\n      <div className=\"bw-MainContainer\">\r\n        {bannerList.map((bannerItem, index) => {\r\n          return (\r\n            <div\r\n              className={\r\n                \"bw-Banner\" +\r\n                (bannerItem.length <= 0 ? \" bw-BannerHidden\" : \"\") +\r\n                (bannerItem.indexOf(\"Success\") > -1\r\n                  ? \" bw-BannerSuccess\"\r\n                  : \" bw-BannerFailure\")\r\n              }\r\n            >\r\n              <span>{bannerItem}</span>\r\n              <Icon\r\n                iconName=\"ChromeClose\"\r\n                className=\"closeIcon\"\r\n                data-index={index}\r\n                onClick={closeBannerOnClick}\r\n              />\r\n            </div>\r\n          );\r\n        })}\r\n        {!hasAPIKey && (\r\n          <StartPage\r\n            addBanner={addBanner}\r\n            setAPIKeyAdded={() => {\r\n              setHasAPIKey(true);\r\n              setBannerList([]);\r\n            }}\r\n          />\r\n        )}\r\n        {hasAPIKey && <Dashboard addBanner={addBanner} />}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' },\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then(registration => {\r\n        registration.unregister();\r\n      })\r\n      .catch(error => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport { App } from './components/App';\r\nimport * as serviceWorker from './serviceWorker';\r\nimport { initializeIcons } from \"@fluentui/react/lib/Icons\";\r\n\r\ninitializeIcons();\r\n\r\nvar rootElement = document.getElementById(\"bwAppRoot\");\r\n\r\nif (rootElement !== null) {\r\n  ReactDOM.render(\r\n    <React.StrictMode>\r\n      <App />\r\n    </React.StrictMode>,\r\n    rootElement\r\n  );\r\n}\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}